# YoForex Replit Migration Guide

## The Problem
When you import a project from GitHub to a new Replit account, **many critical components are NOT transferred automatically**:

‚ùå **NOT Transferred:**
- Database data (only schema structure is imported, tables are empty)
- Environment variables and secrets
- Installed packages (need reinstallation)
- Active workflows configuration (may need reconfiguration)
- Authentication sessions

‚úÖ **What IS Transferred:**
- All source code files
- Database schema definitions (structure only)
- Configuration files (package.json, etc.)
- Static assets

---

## Complete Migration Solution

### Step 1: Prepare Your Export (Original Replit)

#### A. Export Database Data
Before exporting to GitHub, you need to export your database data:

```bash
# Export all data to SQL dump file
npm run db:export
```

This creates a `database-export.sql` file with all your data.

**Alternative: Manual Export via Replit Database Tool**
1. Open Database pane in Replit
2. Click "Export" button
3. Download the SQL dump file
4. Save it locally (you'll need this for the new Replit)

#### B. Document Your Environment Variables
Create a file called `.env.example` (already exists in this project):

```bash
# Copy your actual .env to .env.example (remove actual values)
cp .env .env.example

# Then edit .env.example to show which variables are needed
# Replace actual values with descriptive placeholders
```

**Important Variables for YoForex:**
- `DATABASE_URL` - PostgreSQL connection string (auto-generated by Replit)
- `PGHOST`, `PGPORT`, `PGUSER`, `PGPASSWORD`, `PGDATABASE` - Database credentials
- Any API keys (Stripe, email services, etc.)

#### C. Push to GitHub
```bash
git add .
git commit -m "Complete project export with migration guide"
git push origin main
```

---

### Step 2: Import to New Replit Account

#### A. Import from GitHub
1. Log into your new Replit account
2. Click "+ Create Repl"
3. Select "Import from GitHub"
4. Paste your GitHub repository URL
5. Click "Import from GitHub"

#### B. Wait for Initial Setup
Replit will automatically:
- Clone the repository
- Detect the project type (Next.js)
- Create a PostgreSQL database (empty)
- Install basic dependencies

---

### Step 3: Configure Database (New Replit)

#### A. Set Up Database Schema
The database tables exist but are **completely empty**. Push the schema:

```bash
# This creates all tables according to shared/schema.ts
npm run db:push
```

If you see data-loss warnings:
```bash
npm run db:push --force
```

#### B. Import Your Data

**Option 1: Use the Database Tool (Recommended)**
1. Open the Database pane in Replit
2. Click "Import"
3. Upload your `database-export.sql` file
4. Wait for import to complete

**Option 2: Use Command Line**
```bash
# Upload your database-export.sql file to the Replit workspace first
# Then run:
psql $DATABASE_URL < database-export.sql
```

#### C. Run Seed Data (If No Export Available)
If you don't have a database export, use the seed script:

```bash
# This creates sample data for testing
npm run db:seed
```

---

### Step 4: Configure Environment Variables

#### A. Check Which Variables Are Needed
Look at `.env.example` to see required variables.

#### B. Add Database Variables (Auto-Generated)
These are automatically created by Replit:
- `DATABASE_URL`
- `PGHOST`, `PGPORT`, `PGUSER`, `PGPASSWORD`, `PGDATABASE`

You can verify they exist:
```bash
env | grep PG
env | grep DATABASE_URL
```

#### C. Add Missing Secrets
Use the Replit Secrets tool:
1. Click the lock icon (üîí) in the left sidebar
2. Add each required secret:
   - Key: `STRIPE_SECRET_KEY` (if using Stripe)
   - Value: Your actual API key
   - Click "Add new secret"

**Never commit actual secrets to GitHub!**

---

### Step 5: Install Dependencies & Start

#### A. Install Node Packages
```bash
# This should happen automatically, but if not:
npm install
```

#### B. Start the Application
```bash
# The workflow should auto-start, but if not:
npm run dev
```

#### C. Verify Everything Works
Open the Webview and check:
- ‚úÖ Homepage loads
- ‚úÖ Categories page shows all categories
- ‚úÖ Discussions page shows threads
- ‚úÖ Broker reviews page works
- ‚úÖ User authentication works
- ‚úÖ Database queries work

---

## Troubleshooting Common Issues

### Issue 1: "Categories Not Showing"
**Cause:** Database is empty  
**Solution:**
```bash
npm run db:push          # Create tables
npm run db:seed          # Add sample data
# OR import your database-export.sql
```

### Issue 2: "Authentication Not Working"
**Cause:** Missing Replit Auth integration  
**Solution:**
1. Go to Tools ‚Üí Integrations
2. Enable "Replit Auth"
3. Restart the workflow

### Issue 3: "API Endpoints Returning 500 Errors"
**Cause:** Missing environment variables or empty database  
**Solution:**
```bash
# Check environment variables
env | grep DATABASE

# Verify database has data
psql $DATABASE_URL -c "SELECT COUNT(*) FROM categories;"

# If returns 0, run seed:
npm run db:seed
```

### Issue 4: "npm run dev Fails"
**Cause:** Missing dependencies  
**Solution:**
```bash
rm -rf node_modules
rm package-lock.json
npm install
npm run dev
```

### Issue 5: "Database Connection Errors"
**Cause:** DATABASE_URL not set  
**Solution:**
- Replit should auto-generate this
- If missing, create a new PostgreSQL database in the Database pane
- Check if it appears: `echo $DATABASE_URL`

---

## Quick Migration Checklist

### Before Export (Original Replit):
- [ ] Export database data (`npm run db:export` or via Database tool)
- [ ] Update `.env.example` with all required variables
- [ ] Commit and push to GitHub
- [ ] Download database export file locally (backup)

### After Import (New Replit):
- [ ] Import from GitHub URL
- [ ] Wait for automatic setup to complete
- [ ] Push database schema: `npm run db:push`
- [ ] Import database data (upload SQL file via Database tool)
- [ ] Add any required secrets via Secrets tool
- [ ] Install dependencies: `npm install`
- [ ] Start workflow: `npm run dev`
- [ ] Verify all pages work correctly

---

## Best Practices

### 1. Keep .env.example Updated
Always update `.env.example` when you add new environment variables:
```bash
# Good .env.example
DATABASE_URL=postgresql://user:password@host:port/database
STRIPE_SECRET_KEY=sk_test_your_key_here
SENDGRID_API_KEY=SG.your_key_here
```

### 2. Regular Database Backups
Export your database regularly:
```bash
# Weekly backup
npm run db:export
# Download the file and save it safely
```

### 3. Use Seed Scripts for Development
Create comprehensive seed scripts for testing:
```bash
# server/seed.ts already has extensive seed data
npm run db:seed
```

### 4. Document Custom Setup Steps
Add any custom setup steps to this guide if you add new features that require special configuration.

---

## Production Deployment Notes

When deploying to production (not just Replit import):

1. **Never use seed data in production**
2. **Always use environment-specific secrets**
3. **Set up proper database backups**
4. **Use production database, not development**
5. **Configure proper SSL/TLS**
6. **Set NODE_ENV=production**

---

## Need Help?

If you encounter issues not covered here:

1. Check the main `README.md` for project documentation
2. Review `COMPLETE_PLATFORM_GUIDE.md` for architecture details
3. Check workflow logs for errors
4. Use Replit AI Assistant for debugging
5. Verify all environment variables are set: `env | grep -E '(DATABASE|PG|API|SECRET)'`

---

## Migration Script (Advanced)

For advanced users, create an automated migration script:

```bash
#!/bin/bash
# migration.sh - Automated migration script

echo "üöÄ Starting YoForex Migration..."

# Step 1: Install dependencies
echo "üì¶ Installing dependencies..."
npm install

# Step 2: Push database schema
echo "üóÑÔ∏è Setting up database schema..."
npm run db:push --force

# Step 3: Check for database export file
if [ -f "database-export.sql" ]; then
    echo "üì• Importing database data..."
    psql $DATABASE_URL < database-export.sql
else
    echo "üå± No export found, using seed data..."
    npm run db:seed
fi

# Step 4: Verify setup
echo "‚úÖ Verifying setup..."
psql $DATABASE_URL -c "SELECT COUNT(*) FROM categories;"

echo "‚ú® Migration complete!"
echo "üåê Run 'npm run dev' to start the application"
```

Make it executable:
```bash
chmod +x migration.sh
./migration.sh
```

---

**Last Updated:** October 28, 2025  
**Version:** 1.0.0  
**Platform:** YoForex - Expert Advisor Forum & Marketplace
